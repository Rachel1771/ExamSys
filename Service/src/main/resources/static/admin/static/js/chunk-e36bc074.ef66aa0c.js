(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e36bc074"],{"74db":function(t,e,n){"use strict";n.r(e);n("99af");var a=function(){var t=this,e=t._self._c;return e("el-container",{directives:[{name:"loading",rawName:"v-loading",value:t.pageLoading,expression:"pageLoading"}],staticClass:"container"},[e("div",{staticClass:"container-main"},[e("div",{staticClass:"top"},[e("div",{staticClass:"top-left"},[e("h3",[t._v("当前课堂状态："),e("span",{class:t.currentStatus?"signing":"wait"},[t._v(t._s(t.currentStatus?"正在签到":"未开启签到")+" ")])]),t.currentStatus?e("h3",[t._v("签到码："),e("span",{staticStyle:{color:"#fc6a6a"}},[t._v(t._s(this.code))])]):t._e(),e("div",{staticStyle:{display:"flex"}},[t.currentStatus?e("el-button",{attrs:{type:"warning"},on:{click:t.closeSignIn}},[t._v("结束签到")]):e("el-button",{attrs:{type:"primary"},on:{click:t.startSignIn}},[t._v("开始签到")])],1)]),e("div",{staticClass:"top-right",attrs:{id:"echarts-rate"}})]),0!==t.studentList.length?e("el-table",{staticStyle:{width:"100%"},attrs:{border:"",fit:"","highlight-current-row":"",data:t.studentList}},[e("el-table-column",{attrs:{align:"center",width:"150",prop:"studentName",label:"姓名"}}),e("el-table-column",{attrs:{align:"center",width:"150",label:"签到状态"},scopedSlots:t._u([{key:"default",fn:function(n){var a=n.row;return[e("p",{style:{color:"TRUE"===a.statues?"green":"red"}},[t._v(t._s("TRUE"===a.statues?"已签到":"未签到"))])]}}],null,!1,1234346187)}),e("el-table-column",{attrs:{label:"签到时间",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[t._v(" "+t._s(n.recordTime?"".concat(n.recordTime.date.year,"年").concat(n.recordTime.date.month,"月").concat(n.recordTime.date.day,"日 ").concat(n.recordTime.time.hour,":").concat(n.recordTime.time.minute,":").concat(n.recordTime.time.second):"——")+" ")]}}],null,!1,4187733223)})],1):t._e()],1)])},s=[],i=(n("13d5"),n("d3b7"),n("313e")),r=n("c24f"),o={name:"index",data:function(){return{pageLoading:!0,studentList:[],currentStatus:!1,code:null,echartsSignRate:null,userData:{}}},created:function(){var t=this;r["a"].getCurrentUser().then((function(e){console.log(e),e.response?t.userData=e.response:t.$message.warning("发生错误")}))},mounted:function(){var t=this;this.echartsSignRate=i["a"](document.getElementById("echarts-rate"),"macarons"),r["a"].getAllRecord().then((function(e){setTimeout((function(){t.pageLoading=!1}),1e3),t.studentList=e.list,t.echartsSignRate.setOption(t.option([{value:t.signInRate,name:"到课"},{value:1-t.signInRate,name:"缺勤"}])),console.log(e),!0===e.isAllowed?(t.currentStatus=!0,t.code=e.token,t.getAllRecord()):!1===e.isAllowed&&t.$message.info("当前未开启签到")}))},computed:{signInRate:function(){return this.studentList.reduce((function(t,e){return"TRUE"===e.statues?t+1:t}),0)/this.studentList.length}},methods:{startSignIn:function(){var t=this;r["a"].createRecord({courseId:123456,teacherId:this.userData.id}).then((function(e){"number"===typeof e?(t.code=e,t.$message.success("签到码开启成功"),t.getAllRecord()):t.$message.warning("发生错误"),t.currentStatus=!0}))},closeSignIn:function(){var t=this;r["a"].closeRecord({flag:!0}).then((function(e){1===e.code?(t.$message.success("关闭签到成功"),t.currentStatus=!1,t.getAllRecord()):t.$message.warning("发生错误")}))},getAllRecord:function(){var t=this;r["a"].getAllRecord({flag:!1}).then((function(e){console.log(e),e.isAllowed?(t.studentList=e.list,t.currentStatus=!0,t.code=e.token,t.echartsSignRate.setOption(t.option([{value:t.signInRate,name:"到课"},{value:1-t.signInRate,name:"缺勤"}])),setTimeout((function(){t.getAllRecord()}),2e3)):(t.currentStatus=!1,t.studentList=e.list,t.echartsSignRate.setOption(t.option([{value:t.signInRate,name:"到课"},{value:1-t.signInRate,name:"缺勤"}])))}))},option:function(t){return{tooltip:{trigger:"item"},legend:{top:"5%",left:"center"},color:["#79ef71","#ff6363"],series:[{name:"到课率",type:"pie",radius:["30%","60%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:5,borderWidth:0},label:{show:!1,position:"center"},labelLine:{show:!1},data:t}]}}}},c=o,l=(n("9b37"),n("2877")),u=Object(l["a"])(c,a,s,!1,null,"5ef3c00c",null);e["default"]=u.exports},"9b37":function(t,e,n){"use strict";n("d60c")},d60c:function(t,e,n){}}]);